# [<img src="https://kaggle.com/static/images/site-logo.png" height="50" style="margin-bottom:-15px" />](https://kaggle.com) Environments

```bash
pip install kaggle-environments
```

**BETA RELEASE** - Breaking changes may be introduced!

## TLDR;

```python
from kaggle_environments import make

# Setup a tictactoe environment.
env = make("tictactoe")

# Basic agent which marks the first available cell.
def my_agent(obs):
  return [c for c in range(len(obs.board)) if obs.board[c] == 0][0]

# Run the basic agent against a default agent which chooses a "random" move.
env.run([my_agent, "random"])

# Render an html ipython replay of the tictactoe game.
env.render(mode="ipython")
```

<!-- uv run train_connectx_rl_robust.py --episodes 50000 --eval-freq 1000 -->

ğŸ§  ConnectX PPOæ¨¡å‹åƒæ•¸è©³è§£
ğŸ“Š ç¶²çµ¡çµæ§‹åƒæ•¸
input_size: 126
ä½œç”¨: ç¥ç¶“ç¶²çµ¡è¼¸å…¥å±¤çš„ç¶­åº¦
è¨ˆç®—: 6è¡Œ Ã— 7åˆ— Ã— 3é€šé“ = 126
è©³ç´°:
é€šé“1: ç•¶å‰ç©å®¶çš„æ£‹å­ä½ç½® (6Ã—7=42)
é€šé“2: å°æ‰‹çš„æ£‹å­ä½ç½® (6Ã—7=42)
é€šé“3: ç©ºä½ç½® (6Ã—7=42)
ç‚ºä»€éº¼: è®“AIèƒ½ç†è§£å®Œæ•´çš„æ£‹ç›¤ç‹€æ…‹
hidden_size: 512
ä½œç”¨: éš±è—å±¤çš„ç¥ç¶“å…ƒæ•¸é‡
å½±éŸ¿: æ¨¡å‹çš„è¡¨é”èƒ½åŠ›å’Œè¤‡é›œåº¦
é¸æ“‡åŸå› :
å¤ªå°: å­¸ä¸åˆ°è¤‡é›œç­–ç•¥
å¤ªå¤§: è¨“ç·´æ…¢ã€å®¹æ˜“éæ“¬åˆ
512æ˜¯ConnectXçš„ç”œèœœé»
num_layers: 1024
ä½œç”¨: éš±è—å±¤çš„æ•¸é‡
å½±éŸ¿: æ¨¡å‹æ·±åº¦ï¼Œå­¸ç¿’è¤‡é›œæ¨¡å¼çš„èƒ½åŠ›
ç‚ºä»€éº¼: æ›´æ·±çš„ç¶²çµ¡èƒ½å­¸ç¿’æ›´è¤‡é›œçš„ConnectXç­–ç•¥
ğŸ¯ PPOç®—æ³•åƒæ•¸
learning_rate: 3.0e-07 (0.0000003)
ä½œç”¨: æ§åˆ¶æ¨¡å‹åƒæ•¸æ›´æ–°çš„æ­¥é•·
ç‚ºä»€éº¼é€™éº¼å°:
PPOéœ€è¦ç©©å®šçš„å­¸ç¿’
å¤ªå¤§æœƒå°è‡´ç­–ç•¥éœ‡ç›ª
å¤ªå°å­¸ç¿’å¤ªæ…¢
æ•ˆæœ: ç¢ºä¿ç©©å®šæ”¶æ–‚åˆ°æœ€å„ªç­–ç•¥
gamma: 0.99 (æŠ˜æ‰£å› å­)
ä½œç”¨: æ§åˆ¶å°æœªä¾†çå‹µçš„é‡è¦–ç¨‹åº¦
æ„ç¾©:
0.99æ„å‘³è‘—æœªä¾†çå‹µåƒ¹å€¼99%
è®“AIé‡è¦–é•·æœŸå‹åˆ©è€ŒéçŸ­æœŸå¾—åˆ†
ç‚ºä»€éº¼: ConnectXéœ€è¦é•·æœŸè¦åŠƒï¼Œä¸èƒ½åªçœ‹ç•¶å‰æ­¥
eps_clip: 0.2 (PPOè£å‰ªåƒæ•¸)
ä½œç”¨: é™åˆ¶ç­–ç•¥æ›´æ–°çš„å¹…åº¦
é˜²æ­¢: ç­–ç•¥è®ŠåŒ–å¤ªåŠ‡çƒˆå°è‡´å­¸ç¿’ä¸ç©©å®š
æ©Ÿåˆ¶: å¦‚æœæ–°èˆŠç­–ç•¥å·®ç•°>20%ï¼Œå°±è£å‰ªæ›´æ–°
æ•ˆæœ: ç¢ºä¿å­¸ç¿’éç¨‹å¹³ç©©
k_epochs: 4 (PPOæ›´æ–°è¼ªæ•¸)
ä½œç”¨: æ¯æ‰¹æ•¸æ“šé‡è¤‡è¨“ç·´çš„æ¬¡æ•¸
å¹³è¡¡:
å¤ªå°‘: æ•¸æ“šåˆ©ç”¨ä¸å……åˆ†
å¤ªå¤š: å®¹æ˜“éæ“¬åˆèˆŠæ•¸æ“š
é¸æ“‡: 4æ¬¡æ˜¯ç¶“é©—æœ€ä½³å€¼
ğŸ† çå‹µèˆ‡åƒ¹å€¼åƒæ•¸
gae_lambda: 0.95 (GAEåƒæ•¸)
ä½œç”¨: æ§åˆ¶å„ªå‹¢ä¼°è¨ˆçš„åå·®-æ–¹å·®æ¬Šè¡¡
æ©Ÿåˆ¶: çµåˆTDå­¸ç¿’å’ŒMonte Carlo
æ•ˆæœ:
æ¥è¿‘1: ä½åå·®ï¼Œé«˜æ–¹å·®
æ¥è¿‘0: é«˜åå·®ï¼Œä½æ–¹å·®
0.95æ˜¯å¹³è¡¡é»
value_coef: 0.5 (åƒ¹å€¼æå¤±ä¿‚æ•¸)
ä½œç”¨: æ§åˆ¶åƒ¹å€¼å‡½æ•¸å­¸ç¿’çš„é‡è¦æ€§
å¹³è¡¡: ç­–ç•¥å­¸ç¿’ vs åƒ¹å€¼è©•ä¼°
ç‚ºä»€éº¼0.5: åƒ¹å€¼å‡½æ•¸å’Œç­–ç•¥åŒç­‰é‡è¦
entropy_coef: 0.01 (ç†µä¿‚æ•¸)
ä½œç”¨: é¼“å‹µæ¢ç´¢ï¼Œé˜²æ­¢ç­–ç•¥éæ—©æ”¶æ–‚
æ©Ÿåˆ¶: æ·»åŠ ç­–ç•¥éš¨æ©Ÿæ€§çš„çå‹µ
æ•ˆæœ:
å¤ªå¤§: AIè¡Œç‚ºå¤ªéš¨æ©Ÿ
å¤ªå°: å®¹æ˜“é™·å…¥å±€éƒ¨æœ€å„ª
0.01æä¾›é©åº¦æ¢ç´¢
ğŸ’¾ æ•¸æ“šç®¡ç†åƒæ•¸
buffer_size: 5000
ä½œç”¨: ç¶“é©—å›æ”¾ç·©è¡å€å¤§å°
æ„ç¾©: å­˜å„²å¤šå°‘æ­¥çš„éŠæˆ²ç¶“é©—
é¸æ“‡:
å¤ªå°: æ•¸æ“šå¤šæ¨£æ€§ä¸è¶³
å¤ªå¤§: å…§å­˜æ¶ˆè€—å¤§ï¼ŒèˆŠæ•¸æ“šå½±éŸ¿
5000æ­¥è¦†è“‹ç´„100-200å ´éŠæˆ²
min_batch_size: 128
ä½œç”¨: æœ€å°æ‰¹æ¬¡å¤§å°æ‰é–‹å§‹è¨“ç·´
åŸå› :
ç¢ºä¿æ¢¯åº¦ä¼°è¨ˆç©©å®š
æé«˜GPUåˆ©ç”¨æ•ˆç‡
æ¸›å°‘è¨“ç·´å™ªéŸ³
weight_decay: 0.0001
ä½œç”¨: L2æ­£å‰‡åŒ–ï¼Œé˜²æ­¢éæ“¬åˆ
æ©Ÿåˆ¶: æ‡²ç½°éå¤§çš„ç¶²çµ¡æ¬Šé‡
æ•ˆæœ: æé«˜æ¨¡å‹æ³›åŒ–èƒ½åŠ›
ğŸ“ˆ è¨“ç·´æ§åˆ¶åƒæ•¸
max_episodes: 50000
ä½œç”¨: æœ€å¤§è¨“ç·´å›åˆæ•¸
ä¼°è¨ˆ: ç´„éœ€è¦20000-30000å›åˆé”åˆ°94%å‹ç‡
å®‰å…¨é‚Šéš›: 50000ç¢ºä¿å……åˆ†è¨“ç·´
eval_frequency: 25
ä½œç”¨: æ¯25å›åˆè©•ä¼°ä¸€æ¬¡æ¨¡å‹
å¹³è¡¡:
å¤ªé »ç¹: æµªè²»è¨ˆç®—è³‡æº
å¤ªç¨€å°‘: ç„¡æ³•åŠæ™‚ç™¼ç¾å•é¡Œ
é¸æ“‡: 25å›åˆç´„1-2åˆ†é˜ï¼Œåˆé©çš„ç›£æ§é »ç‡
eval_games: 50
ä½œç”¨: æ¯æ¬¡è©•ä¼°ç©50å ´éŠæˆ²
çµ±è¨ˆæ„ç¾©: 50å ´è¶³ä»¥ç²å¾—å¯é çš„å‹ç‡ä¼°è¨ˆ
ç½®ä¿¡åº¦: Â±7%å·¦å³çš„å‹ç‡èª¤å·®
checkpoint_frequency: 2000
ä½œç”¨: æ¯2000å›åˆä¿å­˜ä¸€æ¬¡æ¨¡å‹
ç›®çš„:
é˜²æ­¢è¨“ç·´ä¸­æ–·ä¸Ÿå¤±é€²åº¦
æ–¹ä¾¿å›æ»¾åˆ°ä¹‹å‰ç‰ˆæœ¬
å­˜å„²: ç´„æ¯1-2å°æ™‚ä¿å­˜ä¸€æ¬¡
early_stopping_patience: 5000
ä½œç”¨: 5000å›åˆæ²’æ”¹é€²å°±åœæ­¢è¨“ç·´
é˜²æ­¢: æµªè²»è¨ˆç®—è³‡æºåœ¨å·²æ”¶æ–‚çš„æ¨¡å‹ä¸Š
è¨ˆç®—: 5000Ã·25=200æ¬¡è©•ä¼°æ²’æ”¹é€²æ‰åœæ­¢
ğŸ¯ åƒæ•¸èª¿å„ªå»ºè­°
å¦‚æœè¨“ç·´å¤ªæ…¢:
å¢åŠ  learning_rate åˆ° 5e-7
æ¸›å°‘ eval_frequency åˆ° 50
æ¸›å°‘ hidden_size åˆ° 256
å¦‚æœæ¨¡å‹ä¸ç©©å®š:
æ¸›å°‘ learning_rate åˆ° 1e-7
å¢åŠ  eps_clip åˆ° 0.3
å¢åŠ  min_batch_size åˆ° 256
å¦‚æœå‹ç‡åœæ»¯:
å¢åŠ  entropy_coef åˆ° 0.02
å¢åŠ  buffer_size åˆ° 10000
èª¿æ•´ gamma åˆ° 0.98
é€™äº›åƒæ•¸ç¶“éç²¾å¿ƒèª¿å„ªï¼Œå½¢æˆäº†ä¸€å€‹å¹³è¡¡çš„è¨“ç·´ç³»çµ±ï¼Œèƒ½å¤ ç©©å®šåœ°å°‡AIè¨“ç·´åˆ°94%çš„å‹ç‡æ°´å¹³ï¼ğŸ†
 ERROR - è¨“ç·´å›åˆ 90801 æ™‚å‡ºéŒ¯: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2,) + inhomogeneous part.
ERROR - è¨“ç·´å›åˆ 90807 æ™‚å‡ºéŒ¯: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2,) + inhomogeneous part.
